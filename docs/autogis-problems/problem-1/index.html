<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/main.css">
    <title></title>
</head>

<body class="site-body">
    
<header class="site-header">
    <div class="site-header__content">
        <h1 class="site-title">
            <a href="/" class="site-title__text">AutoGIS with Rust</a>
        </h1>
        <nav class="site-nav">
    <button type="button" class="hamburger" id="hamburger-button" aria-haspopup="true" aria-controls="site-nav-items">
        <div class="hamburger__top-row"></div>
        <div class="hamburger__middle-row"></div>
        <div class="hamburger__bottom-row"></div>
    </button>
    <ul id="site-nav-items" class="site-nav__items" role="menu" aria-labelledby="hamburger-button">
        <li class="site-nav__item" role="none"><a class="site-nav__link" role="menuitem"
                href="/autogis-problems/introduction/">Introduction</a>
        </li>
        <li class="site-nav__item" role="none">
            <button type="button" class="site-nav__link dropdown__button" id="problems-dropdown-button"
                aria-haspopup="true" aria-controls="problems-dropdown-items"><span>Problems</span><svg
                    xmlns="http://www.w3.org/2000/svg" class="dropdown__expand" id="problems-dropdown-expand">
                    <path d="m24 30.75-12-12 2.15-2.15L24 26.5l9.85-9.85L36 18.8Z" />
                </svg></button>
            <ul id="problems-dropdown-items" class="dropdown__items" role="menu"
                aria-labelledby="problems-dropdown-button">
                <li class="dropdown__item" role="none"><a class="dropdown__link" role="menuitem"
                        href="/autogis-problems/problem-1/">1: Creating basic geometries</a>
                </li>
            </ul>
        </li>
    </ul>
</nav>
    </div>
</header>
<main class="page-body">
    <article>
        <h1>Problem 1: Creating basic geometries</h1>
        <h2>Part 1: Creating points</h2>
<blockquote>
<p>Create a function called <code>create_point_geom()</code> that has two parameters (<code>x_coord</code>, <code>y_coord</code>). Function should create a <code>shapely</code> <code>Point</code> geometry object and return that.</p>
</blockquote>
<p>My interpretation of this is that I need a <code>Point</code> <code>struct</code> and a <code>new</code> constructor that takes <code>x</code> and <code>y</code> parameters, so let's get started:</p>
<pre class="language-rust"><code class="language-rust"><span class="token comment">// main.rs</span><br><br><span class="token attribute attr-name">#[derive(Debug)]</span><br><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">impl</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span><br>    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br>        <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token macro property">dbg!</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>This is pretty basic. It works but it only handles <code>f64</code>.</p>
<p>We can handle any number by using the <a href="https://docs.rs/num-traits/0.2.15/num_traits/cast/trait.NumCast.html"><code>NumCast</code></a> trait from the <a href="https://crates.io/crates/num-traits"><code>num_traits</code></a> crate.</p>
<p>To add <code>num-traits</code> using the excellent <a href="https://crates.io/crates/cargo-edit"><code>cargo-edit</code></a> crate run the following in our terminal:</p>
<pre class="language-sh"><code class="language-sh">$ <span class="token function">cargo</span> <span class="token function">add</span> num-traits</code></pre>
<p>Now the caller can pass any type that can be cast to a <code>f64</code>.</p>
<pre class="language-diff-rust"><code class="language-diff-rust">// main.rs<br><br>#[derive(Debug)]<br>pub struct Point([f64; 2]);<br><br>impl Point {<br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token keyword">f64</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>        <span class="token keyword">let</span> x_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span>        <span class="token keyword">let</span> y_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>        <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>        <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x_float<span class="token punctuation">,</span> y_float<span class="token punctuation">]</span><span class="token punctuation">)</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}<br><br>fn main() {<br><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>   <span class="token macro property">dbg!</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><br></span>}</code></pre>
<p>That's better! Now the caller can pass any type that can be cast to <code>f64</code>, they can even pass two different types that can be cast to <code>f64</code>. I'm not sure why you'd want to do that but you can and that's the main thing.</p>
<p>Now to add some documentation. One of my favourite things about Rust is that it supports <a href="https://doc.rust-lang.org/rustdoc/write-documentation/documentation-tests.html">documentation tests</a> out-of-the-box. This means that we can write examples and unit tests in one go.</p>
<p>However, to compare the two <code>Point</code> objects we need to derive <code>PartialEq</code> and <code>PartialOrd</code>.</p>
<p>This is also a good time to move the <code>Point</code> struct and it's methods from <code>main.rs</code> to it's own file.</p>
<pre class="language-diff-rust"><code class="language-diff-rust">// point.rs<br><br>use num_traits::{self, NumCast};<br><br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span> <span class="token attribute attr-name">#[derive(Debug)]</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span> <span class="token attribute attr-name">#[derive(Debug, PartialEq, PartialOrd)]</span><br></span>pub struct Point([f64; 2]);<br><br>impl Point {<br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `Point`.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// # Examples:</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new point from x and y floats or x and y integers.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// use auto_gis_with_rust::Point;</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let point_0 = Point::new(0.0, 1.0);</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let point_1 = Point::new(0, 1);</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// assert_eq!(point_0, point_1);</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> x_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> y_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x_float<span class="token punctuation">,</span> y_float<span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}</code></pre>
<p>And expose it via <code>lib.rs</code>.</p>
<pre class="language-rust"><code class="language-rust"><span class="token comment">// lib.rs</span><br><br><span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">point</span><span class="token punctuation">;</span></code></pre>
<p>Now we can import our <code>Point struct</code> in <code>main.rs</code>.</p>
<pre class="language-diff-rust"><code class="language-diff-rust">// main.rs<br><br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span> <span class="token keyword">use</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token class-name">NumCast</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span> <span class="token keyword">use</span> <span class="token namespace">auto_gis_with_rust<span class="token punctuation">::</span>point<span class="token punctuation">::</span></span><span class="token class-name">Point</span><span class="token punctuation">;</span><br></span><br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span> <span class="token attribute attr-name">#[derive(Debug)]</span><br><span class="token prefix deleted">-</span> <span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span><br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span> <span class="token keyword">impl</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>    <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token punctuation">,</span> <span class="token class-name">U</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token class-name">T</span><span class="token punctuation">,</span> y<span class="token punctuation">:</span> <span class="token class-name">U</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>       <span class="token keyword">let</span> x_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix deleted">-</span>       <span class="token keyword">let</span> y_float<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix deleted">-</span>        <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x_float<span class="token punctuation">,</span> y_float<span class="token punctuation">]</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>    <span class="token punctuation">}</span><br><span class="token prefix deleted">-</span> <span class="token punctuation">}</span><br></span><br>fn main() {<br><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token class-name">Point</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>   <span class="token macro property">dbg!</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span><br></span>}</code></pre>
<h2>Part 2: Creating LineStrings</h2>
<blockquote>
<p>2: Create a function called create_line_geom() that takes a list of Shapely Point objects as parameter called points and returns a LineString object of those input points. In addition, you should take care that the function is used as it should:</p>
<ul>
<li>Inside the function, you should first check with assert -functionality that the input is a list (see lesson 6 from the Geo-Python course and hints for this exercise). If something else than a list is passed for the function, you should return an Error message: &quot;Input should be a list!&quot;</li>
<li>You should also check with assert that the input list contains at least two values. If not, return an Error message: &quot;LineString object requires at least two Points!&quot;</li>
<li>Optional: Finally, you should check with assert that all values in the input list are truly Shapely Points. If not, return an Error message: &quot;All list values should be Shapely Point objects!&quot;</li>
</ul>
</blockquote>
<p>So, we need:</p>
<ul>
<li>A LineString object</li>
<li>A constructor that takes a list of &quot;points&quot;</li>
<li>An error message if that list doesn't contain two or more items</li>
</ul>
<p>We don't need to worry about checking that the input will be a list (or a <code>Vec</code> in our case) because Rust is a statically typed language and the compiler will complain if we try and call our <code>new</code> constructor on anything other than the type we declare in the function signature. However, as noted above, we will need to check that the <code>Vec</code> has two or more items because empty or single item <code>Vec</code>s are still valid <code>Vec</code>s.</p>
<pre class="language-rust"><code class="language-rust"><span class="token comment">// line_string.rs</span><br><br><span class="token keyword">use</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token class-name">NumCast</span><span class="token punctuation">;</span><br><br><span class="token attribute attr-name">#[derive(Debug, PartialEq, PartialOrd)]</span><br><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">LineString</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">impl</span> <span class="token class-name">LineString</span> <span class="token punctuation">{</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>points<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> float_points <span class="token operator">=</span> points<br>            <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>point<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>                point<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>                    <span class="token keyword">let</span> float_point<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                    float_point<br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><span class="token punctuation">)</span><br>            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token class-name">LineString</span><span class="token punctuation">(</span>float_points<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Now we have a new module, we need to import it:</p>
<pre class="language-diff-rust"><code class="language-diff-rust">// lib.rs<br><br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span><span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">line_string</span><span class="token punctuation">;</span><br></span>pub mod point;</code></pre>
<p>Like last time, let's add a docstring with an example we can test too:</p>
<pre class="language-diff-rust"><code class="language-diff-rust">// line_string.rs<br><br>use num_traits::NumCast;<br><br>#[derive(Debug, PartialEq, PartialOrd)]<br>pub struct LineString(Vec&lt;[f64; 2]>);<br><br>impl LineString {<br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `LineString` from a vector of 2-element arrays.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// # Examples:</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `LineString` from a vector of floats or a vector of integers.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// use auto_gis_with_rust::line_string::LineString;</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let line_string_1 = LineString::new(vec![[0., 0.], [1., 1.]]);</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let line_string_2 = LineString::new(vec![[0, 0], [1, 1]]);</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// assert_eq!(line_string_1, line_string_2)</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>points<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> float_points <span class="token operator">=</span> points<br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>point<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>               point<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>                   <span class="token keyword">let</span> float_point<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>                   float_point<br><span class="token prefix unchanged"> </span>               <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token class-name">LineString</span><span class="token punctuation">(</span>float_points<span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}</code></pre>
<p>So, we've got a <code>LineString</code> struct that takes a list of <code>points</code> and the doctest proves it does what we think it should. Let's handle the possibility that we receive less than 2 coordinates.</p>
<p>To do this, we need an error type. Luckily, <code>thiserror</code> has our back:</p>
<pre class="language-rust"><code class="language-rust"><span class="token comment">// error.rs</span><br><br><span class="token keyword">use</span> <span class="token namespace">thiserror<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">;</span><br><br><span class="token attribute attr-name">#[derive(Error, Debug)]</span><br><span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">GeometryError</span> <span class="token punctuation">{</span><br>    <span class="token attribute attr-name">#[error(<span class="token string">"too few coordinates, expected 2 or more, found {0})"</span>)]</span><br>    <span class="token class-name">TooFewCoords</span><span class="token punctuation">(</span><span class="token keyword">usize</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br><span class="token punctuation">}</span></code></pre>
<pre class="language-diff-rust"><code class="language-diff-rust">// line_string.rs<br><br>use num_traits::NumCast;<br><br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span><span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">GeometryError</span><span class="token punctuation">;</span><br></span><br>#[derive(Debug, PartialEq, PartialOrd)]<br>pub struct LineString(Vec&lt;[f64; 2]>);<br><br>impl LineString {<br><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `LineString` from a vector of 2-element arrays.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// # Examples:</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `LineString` from a vector of floats or a vector of integers.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// use auto_gis_with_rust::line_string::LineString;</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// let line_string_1 = LineString::new(vec![[0., 0.], [1., 1.]]);</span><br><span class="token prefix deleted">-</span>    <span class="token comment">/// let line_string_1 = LineString::new(vec![[0., 0.], [1., 1.]]);</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// let line_string_2 = LineString::new(vec![[0, 0], [1, 1]]).unwrap();</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let line_string_2 = LineString::new(vec![[0, 0], [1, 1]]).unwrap();</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// assert_eq!(line_string_1, line_string_2)</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>points<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">Self</span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>        <span class="token keyword">let</span> float_points <span class="token operator">=</span> points<br><span class="token prefix deleted">-</span>            <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>point<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>                point<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>                    <span class="token keyword">let</span> float_point<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix deleted">-</span>                    float_point<br><span class="token prefix deleted">-</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix deleted">-</span>        <span class="token class-name">LineString</span><span class="token punctuation">(</span>float_points<span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>    <span class="token punctuation">}</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>points<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>        <span class="token keyword">let</span> number_of_points <span class="token operator">=</span> points<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span>        <span class="token keyword">if</span> number_of_points <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>            <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">GeometryError</span><span class="token punctuation">::</span><span class="token class-name">TooFewCoords</span><span class="token punctuation">(</span>number_of_points<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>            <span class="token keyword">let</span> float_points <span class="token operator">=</span> points<br><span class="token prefix inserted">+</span>                <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>point<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>                    point<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>                        <span class="token keyword">let</span> float_point<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span>                        float_point<br><span class="token prefix inserted">+</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span>            <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">LineString</span><span class="token punctuation">(</span>float_points<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>        <span class="token punctuation">}</span><br><span class="token prefix inserted">+</span>    <span class="token punctuation">}</span><br></span>}</code></pre>
<h2>Part 3</h2>
<blockquote>
<p>3: Create a function called create_poly_geom() that has one parameter called coords. coords parameter should containt a list of coordinate tuples. The function should create and return a Polygon object based on these coordinates.</p>
<ul>
<li>Inside the function, you should first check with assert -functionality that the input is a list (see lesson 6 and hints). If something else than a list is passed for the function, you should return an Error message: &quot;Input should be a list!&quot;</li>
<li>You should also check with assert that the input list contains at least three values. If not, return an Error message: &quot;Polygon object requires at least three Points!&quot;</li>
<li>Check the data type of the objects in the input list. All values in the input list should be tuples. If not, return an error message: &quot;All list values should be coordinate tuples!&quot; using assert.</li>
<li>Optional: Allow also an input containing a list of Shapely Point objects. If coords contanis a list of Shapely Point objects, return a polygon based on these points. If the input is neither a list of tuples, nor a list of Points, return an appropriate error message using assert.</li>
</ul>
</blockquote>
<p>So, we need:</p>
<ul>
<li>A polygon object</li>
<li>A <code>new</code> constructor that takes a vector of coordinates</li>
<li>An error message if that vector doesn't contain three or more items</li>
</ul>
<p>Additionally, we need to check whether the first and last items in the vector are equal and, if they aren't, we need to close the ring.</p>
<ul>
<li>Assume CCW</li>
</ul>
<p><code>polygon.rs</code> {class=&quot;file-name&quot;}</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token class-name">NumCast</span><span class="token punctuation">;</span><br><br><span class="token keyword">use</span> <span class="token keyword">crate</span><span class="token module-declaration namespace"><span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">GeometryError</span><span class="token punctuation">;</span><br><br><span class="token attribute attr-name">#[derive(Debug, PartialEq, PartialOrd)]</span><br><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Polygon</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">impl</span> <span class="token class-name">Polygon</span> <span class="token punctuation">{</span><br>    <span class="token comment">/// Construct a new `Polygon` from a vector of 2-element arrays.</span><br>    <span class="token comment">///</span><br>    <span class="token comment">/// # Examples:</span><br>    <span class="token comment">///</span><br>    <span class="token comment">/// Construct a new `Polygon` from a vector of floats or a vector of integers.</span><br>    <span class="token comment">///</span><br>    <span class="token comment">/// ```</span><br>    <span class="token comment">/// use auto_gis_with_rust::polygon::Polygon;</span><br>    <span class="token comment">///</span><br>    <span class="token comment">/// let polygon_1 = Polygon::new(vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]).unwrap();</span><br>    <span class="token comment">/// let polygon_2 = Polygon::new(vec![[0, 0], [0, 1], [1, 1]]).unwrap();</span><br>    <span class="token comment">///</span><br>    <span class="token comment">/// assert_eq!(polygon_1, polygon_2)</span><br>    <span class="token comment">/// ```</span><br>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br>        <span class="token keyword">let</span> number_of_coordinates <span class="token operator">=</span> coordinates<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> number_of_coordinates <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">{</span><br>            <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">GeometryError</span><span class="token punctuation">::</span><span class="token class-name">TooFewCoords</span><span class="token punctuation">(</span>number_of_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>            <span class="token keyword">let</span> <span class="token keyword">mut</span> float_coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> coordinates<br>                <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>                    coordinate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>                        <span class="token keyword">let</span> float_coordinate<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                        float_coordinate<br>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token keyword">if</span> float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> float_coordinates<span class="token punctuation">[</span>number_of_coordinates <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><br>                float_coordinates<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<ul>
<li>Update <code>lib.rs</code></li>
</ul>
<p><code>lib.rs</code> {class=&quot;file-name&quot;}</p>
<pre class="language-diff-rust"><code class="language-diff-rust">pub mod error;<br>pub mod line_string;<br>pub mod point;<br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span><span class="token keyword">pub</span> <span class="token keyword">mod</span> <span class="token module-declaration namespace">polygon</span><span class="token punctuation">;</span></code></pre>
<ul>
<li>One problem, this approach doesn't account for internal rings.</li>
</ul>
<p><code>polygon.rs</code> {class=&quot;file-name&quot;}</p>
<pre class="language-diff-rust"><code class="language-diff-rust">use num_traits::NumCast;<br><br>use crate::error::GeometryError;<br><br>#[derive(Debug, PartialEq, PartialOrd)]<br>pub struct PolygonRing(Vec&lt;[f64; 2]>);<br><br>impl PolygonRing {<br><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// Construct a new `Polygon` from a vector of 2-element arrays.</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `PolygonRing` from a vector of 2-element arrays.</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// # Examples:</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// Construct a new `Polygon` from a vector of floats or a vector of integers.</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `PolygonRing` from a vector of floats or a vector of integers.</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// use auto_gis_with_rust::polygon::Polygon;</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// use auto_gis_with_rust::polygon::PolygonRing;</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// let polygon_1 = Polygon::new(vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]).unwrap();</span><br><span class="token prefix deleted">-</span>    <span class="token comment">/// let polygon_2 = Polygon::new(vec![[0, 0], [0, 1], [1, 1]]).unwrap();</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// let polygon_ring_1 = PolygonRing::new(vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]).unwrap();</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let polygon_ring_2 = PolygonRing::new(vec![[0, 0], [0, 1], [1, 1]]).unwrap();</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>    <span class="token comment">/// assert_eq!(polygon_1, polygon_2)</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>    <span class="token comment">/// assert_eq!(polygon_ring_1, polygon_ring_2)</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> number_of_coordinates <span class="token operator">=</span> coordinates<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">if</span> number_of_coordinates <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>           <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">GeometryError</span><span class="token punctuation">::</span><span class="token class-name">TooFewCoords</span><span class="token punctuation">(</span>number_of_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>           <span class="token keyword">let</span> <span class="token keyword">mut</span> float_coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> coordinates<br><span class="token prefix unchanged"> </span>               <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>               <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>                   coordinate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>                       <span class="token keyword">let</span> float_coordinate<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>                       float_coordinate<br><span class="token prefix unchanged"> </span>                   <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>               <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>               <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>           <span class="token keyword">if</span> float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> float_coordinates<span class="token punctuation">[</span>number_of_coordinates <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>               float_coordinates<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">PolygonRing</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>           <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>                <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">PolygonRing</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>           <span class="token punctuation">}</span><br><span class="token prefix unchanged"> </span>       <span class="token punctuation">}</span><br><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}<br><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span><br><span class="token prefix inserted">+</span><span class="token attribute attr-name">#[derive(Debug, PartialEq, PartialOrd)]</span><br><span class="token prefix inserted">+</span><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Polygon</span><span class="token punctuation">(</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">PolygonRing</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span><br><span class="token prefix inserted">+</span><span class="token keyword">impl</span> <span class="token class-name">Polygon</span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `Polygon` from a vector of vectors of 2-element arrays.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// # Examples:</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// Construct a new `Polygon` from a vector of vectors of floats or a vector of vectors of integers.</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// use auto_gis_with_rust::polygon::Polygon;</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let polygon_1 = Polygon::new(vec![vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]]).unwrap();</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// let polygon_2 = Polygon::new(vec![vec![[0, 0], [0, 1], [1, 1]]]).unwrap();</span><br><span class="token prefix inserted">+</span>    <span class="token comment">///</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// assert_eq!(polygon_1, polygon_2)</span><br><span class="token prefix inserted">+</span>    <span class="token comment">/// ```</span><br><span class="token prefix inserted">+</span>    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>rings<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">>></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br><span class="token prefix inserted">+</span>        <span class="token keyword">let</span> polygon_rings<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">PolygonRing</span><span class="token operator">></span> <span class="token operator">=</span> rings<br><span class="token prefix inserted">+</span>            <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>            <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>ring<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">PolygonRing</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>ring<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>            <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix inserted">+</span>        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>polygon_rings<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix inserted">+</span>    <span class="token punctuation">}</span><br></span>}</code></pre>
<p>Okay, so this covers the spirit of the first problem, if not the letter. We have method that returns a <code>Point</code> from an x and y corrdinate, a method that returns a <code>LineString</code> from a vector of coordinates, and a method that returns a <code>Polygon</code> from a vector of vectors of coordinates.</p>
<p>One piece of refactoring: I'm using the same pattern to convert a vector of two item arrays of generics that implement <code>NumCast</code> into a vector of two item arrays of floats in both <code>LineString::new</code> and <code>PolygonRing::new</code>. Let's abstract that pattern into a funtion.</p>
<p><code>helpers.rs</code> {class=&quot;file-name&quot;}</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">use</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token class-name">NumCast</span><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">/// Convert a vector of two-item arrays of generics that implement `NumCast` into a vector of two-item arrays of floats.</span><br><span class="token comment">///</span><br><span class="token comment">/// Examples:</span><br><span class="token comment">///</span><br><span class="token comment">/// ```</span><br><span class="token comment">/// use auto_gis_with_rust::helpers::get_float_coordinates;</span><br><span class="token comment">///</span><br><span class="token comment">/// let output = get_float_coordinates(vec![[0, 0], [0, 1], [1, 1]]);</span><br><span class="token comment">/// let expected = vec![[0., 0.], [0., 1.], [1., 1.]];</span><br><span class="token comment">///</span><br><span class="token comment">/// assert_eq!(output, expected)</span><br><span class="token comment">/// ```</span><br><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">get_float_coordinates</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span><br>    <span class="token keyword">let</span> float_coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> coordinates<br>        <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br>            coordinate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">-></span> <span class="token keyword">f64</span> <span class="token punctuation">{</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><br>        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    float_coordinates<br><span class="token punctuation">}</span></code></pre>
<p><code>polygon.rs</code> {class=&quot;file-name&quot;}</p>
<pre class="language-diff-rust"><code class="language-diff-rust">use num_traits::NumCast;<br><br>use crate::error::GeometryError;<br><br>#[derive(Debug, PartialEq, PartialOrd)]<br>pub struct PolygonRing(Vec&lt;[f64; 2]>);<br><br>impl PolygonRing {<br><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `PolygonRing` from a vector of 2-element arrays.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// # Examples:</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `PolygonRing` from a vector of floats or a vector of integers.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// use auto_gis_with_rust::polygon::PolygonRing;</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// let polygon_ring_1 = PolygonRing::new(vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]).unwrap();</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// let polygon_ring_2 = PolygonRing::new(vec![[0, 0], [0, 1], [1, 1]]).unwrap();</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// assert_eq!(polygon_ring_1, polygon_ring_2)</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> number_of_coordinates <span class="token operator">=</span> coordinates<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">if</span> number_of_coordinates <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>           <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">GeometryError</span><span class="token punctuation">::</span><span class="token class-name">TooFewCoords</span><span class="token punctuation">(</span>number_of_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>       <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br></span><span class="token deleted-sign deleted language-rust"><span class="token prefix deleted">-</span>            <span class="token keyword">let</span> <span class="token keyword">mut</span> float_coordinates<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f64</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> coordinates<br><span class="token prefix deleted">-</span>                <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>                    coordinate<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>coordinate<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span><br><span class="token prefix deleted">-</span>                        <span class="token keyword">let</span> float_coordinate<span class="token punctuation">:</span> <span class="token keyword">f64</span> <span class="token operator">=</span> <span class="token namespace">num_traits<span class="token punctuation">::</span></span><span class="token function">cast</span><span class="token punctuation">(</span>coordinate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix deleted">-</span>                        float_coordinate<br><span class="token prefix deleted">-</span>                    <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>                <span class="token punctuation">}</span><span class="token punctuation">)</span><br><span class="token prefix deleted">-</span>                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br></span><span class="token inserted-sign inserted language-rust"><span class="token prefix inserted">+</span>            <span class="token keyword">let</span> <span class="token keyword">mut</span> float_coordinates <span class="token operator">=</span> <span class="token namespace">helpers<span class="token punctuation">::</span></span><span class="token function">get_float_coordinates</span><span class="token punctuation">(</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">;</span><br></span><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>           <span class="token keyword">if</span> float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">!=</span> float_coordinates<span class="token punctuation">[</span>number_of_coordinates <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>               float_coordinates<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>               <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">PolygonRing</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>               <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">PolygonRing</span><span class="token punctuation">(</span>float_coordinates<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">}</span><br><span class="token prefix unchanged"> </span>       <span class="token punctuation">}</span><br><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}<br><br>#[derive(Debug, PartialEq, PartialOrd)]<br>pub struct Polygon(Vec&lt;PolygonRing>);<br><br>impl Polygon {<br><span class="token unchanged language-rust"><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `Polygon` from a vector of vectors of 2-element arrays.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// # Examples:</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// Construct a new `Polygon` from a vector of vectors of floats or a vector of vectors of integers.</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// use auto_gis_with_rust::polygon::Polygon;</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// let polygon_1 = Polygon::new(vec![vec![[0., 0.], [0., 1.], [1., 1.], [0., 0.]]]).unwrap();</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// let polygon_2 = Polygon::new(vec![vec![[0, 0], [0, 1], [1, 1]]]).unwrap();</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">///</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// assert_eq!(polygon_1, polygon_2)</span><br><span class="token prefix unchanged"> </span>   <span class="token comment">/// ```</span><br><span class="token prefix unchanged"> </span>   <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">NumCast</span><span class="token operator">></span><span class="token punctuation">(</span>rings<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">>></span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token punctuation">,</span> <span class="token class-name">GeometryError</span><span class="token operator">></span> <span class="token punctuation">{</span><br><span class="token prefix unchanged"> </span>       <span class="token keyword">let</span> polygon_rings<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">PolygonRing</span><span class="token operator">></span> <span class="token operator">=</span> rings<br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">into_iter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>ring<span class="token closure-punctuation punctuation">|</span></span> <span class="token class-name">PolygonRing</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>ring<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>           <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token prefix unchanged"> </span>       <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">Polygon</span><span class="token punctuation">(</span>polygon_rings<span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token prefix unchanged"> </span>   <span class="token punctuation">}</span><br></span>}</code></pre>

    </article>
</main>

    <script src="/js/index.js"></script>
</body>

</html>